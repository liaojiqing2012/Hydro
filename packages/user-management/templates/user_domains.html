{% extends 'base.html' %}
{% block title %}用户域权限{% endblock %}
{% block content %}
<div class="section">
    <div class="section__header">
        <h1 class="section__title">用户域权限</h1>
        <a href="/admin/users" class="button button--secondary">返回用户列表</a>
    </div>
    <div class="section__body">
        <div class="data-table">
            <table class="table">
                <thead>
                    <tr>
                        <th>域ID</th>
                        <th>域名称</th>
                        <th>用户角色</th>
                        <th>域内权限</th>
                    </tr>
                </thead>
                <tbody id="domain-list">
                    <!-- 域列表将通过JavaScript动态加载 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // 用户域权限页面的JavaScript代码
    const uid = window.location.pathname.split('/').pop();
    
    async function loadUserDomains() {
        const response = await fetch(`/api/admin/users/${uid}/domains`);
        const domains = await response.json();
        
        const domainList = document.getElementById('domain-list');
        domainList.innerHTML = '';
        
        domains.forEach(domain => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${domain.domain}</td>
                <td>${domain.name}</td>
                <td>${domain.role}</td>
                <td>${domain.permission}</td>
            `;
            domainList.appendChild(tr);
        });
        
        if (domains.length === 0) {
            domainList.innerHTML = '<tr><td colspan="4" class="text-center">该用户未加入任何域</td></tr>';
        }
    }
    
    // 页面加载时加载域权限
    document.addEventListener('DOMContentLoaded', () => {
        loadUserDomains();
    });
</script>
{% endblock %}